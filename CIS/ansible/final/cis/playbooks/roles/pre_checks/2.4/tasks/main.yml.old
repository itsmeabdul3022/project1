#  - name: 2.4 Ensure unused symbolic links are removed
      # The following command will remove all symbolic links that lack a valid target object:
      # Impact: Symbolic Links, used properly, are a tremendous asset - enhancing system usability (ease of use).
      # However, when pointing to nothing (i.e., whatever they pointed at has been removed but not replaced) system integrity is at the mercy of whatever process replaces that filesystem location later.
      # To reduce risk to system integrity any symbolic link that points at a non-existent file-system object is to be removed.
      # Note: most symbolic links that point at no longer existent objects exist due to incomplete software removal procedures.
      # When an authorized application is (re-)installed it's installation process will (or should) re-create the symbolic link.
      #      ansible.builtin.shell: find -L / ( -fstype jfs -o -fstype jfs2 ) -type l | xargs rm
      #args:
      #  warn: false

  - name: Pre_Check 2.4 list unused symbolic links
    raw: test "$(/usr/bin/find -L / \( -fstype jfs -o -fstype jfs2 \) -type l -ls 2>&1 | /usr/bin/grep -v 'Link to an already visited ancestor' | awk '{print} END {if (NR==0) print "none"}' | tee ({{ dest_dir}}/pre_checks_2_4_{{ inventory_hostname }}))" == "none" && echo "PASS" || echo "NO_PASS"
    register: item_2_4_output
    ignore_errors: true

  - debug: msg={{ item_2_4_output.stdout_lines }}
  
  - name: copy the link details to a file on host
    ansible.builtin.copy:
       content: |
         ############ Symbollic links ################################ 
         "{{ item_2_4_output.stdout_lines }}"

       dest: "{{ dest_dir }}/2.4_pre_check_{{ inventory_hostname }}.out"
    delegate_to: localhost

